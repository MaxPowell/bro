// This file was automatically generated by bifcl from /home/ubuntu/bro/src/file_analysis/file_analysis.bif (alternative mode).


#include "file_analysis.bif.h"


#line 5 "file_analysis.bif"

#include "file_analysis/Manager.h"
namespace BifType { namespace Record{ namespace Files {  RecordType * AnalyzerArgs;  } } }

#line 12 "file_analysis.bif"
Val* BifFunc::Files::bro___set_timeout_interval(Frame* frame, val_list* BiF_ARGS)
	
#line 13 "file_analysis.bif"
{
	if ( BiF_ARGS->length() != 2 )
		{
		reporter->Error("Files::__set_timeout_interval() takes exactly 2 argument(s)");
		return 0;
		}
	StringVal* file_id = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());
	double t = (double) ((*BiF_ARGS)[1]->AsInterval());

#line 13 "file_analysis.bif"

	bool result = file_mgr->SetTimeoutInterval(file_id->CheckString(), t);
	return new Val(result, TYPE_BOOL);
	} // end of BifFunc::Files::bro___set_timeout_interval

#line 16 "file_analysis.bif"

#line 19 "file_analysis.bif"
Val* BifFunc::Files::bro___enable_reassembly(Frame* frame, val_list* BiF_ARGS)
	
#line 20 "file_analysis.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("Files::__enable_reassembly() takes exactly 1 argument(s)");
		return 0;
		}
	StringVal* file_id = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());

#line 20 "file_analysis.bif"

	bool result = file_mgr->EnableReassembly(file_id->CheckString());
	return new Val(result, TYPE_BOOL);
	} // end of BifFunc::Files::bro___enable_reassembly

#line 23 "file_analysis.bif"

#line 26 "file_analysis.bif"
Val* BifFunc::Files::bro___disable_reassembly(Frame* frame, val_list* BiF_ARGS)
	
#line 27 "file_analysis.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("Files::__disable_reassembly() takes exactly 1 argument(s)");
		return 0;
		}
	StringVal* file_id = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());

#line 27 "file_analysis.bif"

	bool result = file_mgr->DisableReassembly(file_id->CheckString());
	return new Val(result, TYPE_BOOL);
	} // end of BifFunc::Files::bro___disable_reassembly

#line 30 "file_analysis.bif"

#line 33 "file_analysis.bif"
Val* BifFunc::Files::bro___set_reassembly_buffer(Frame* frame, val_list* BiF_ARGS)
	
#line 34 "file_analysis.bif"
{
	if ( BiF_ARGS->length() != 2 )
		{
		reporter->Error("Files::__set_reassembly_buffer() takes exactly 2 argument(s)");
		return 0;
		}
	StringVal* file_id = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());
	bro_uint_t max = (bro_uint_t) ((*BiF_ARGS)[1]->AsCount());

#line 34 "file_analysis.bif"

	bool result = file_mgr->SetReassemblyBuffer(file_id->CheckString(), max);
	return new Val(result, TYPE_BOOL);
	} // end of BifFunc::Files::bro___set_reassembly_buffer

#line 37 "file_analysis.bif"

#line 40 "file_analysis.bif"
Val* BifFunc::Files::bro___add_analyzer(Frame* frame, val_list* BiF_ARGS)
	
#line 41 "file_analysis.bif"
{
	if ( BiF_ARGS->length() != 3 )
		{
		reporter->Error("Files::__add_analyzer() takes exactly 3 argument(s)");
		return 0;
		}
	StringVal* file_id = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());
	Val* tag = (Val*) ((*BiF_ARGS)[1]);
	Val* args = (Val*) ((*BiF_ARGS)[2]);

#line 41 "file_analysis.bif"

	using BifType::Record::Files::AnalyzerArgs;
	RecordVal* rv = args->AsRecordVal()->CoerceTo(AnalyzerArgs);
	bool result = file_mgr->AddAnalyzer(file_id->CheckString(),
	                                    file_mgr->GetComponentTag(tag), rv);
	Unref(rv);
	return new Val(result, TYPE_BOOL);
	} // end of BifFunc::Files::bro___add_analyzer

#line 48 "file_analysis.bif"

#line 51 "file_analysis.bif"
Val* BifFunc::Files::bro___remove_analyzer(Frame* frame, val_list* BiF_ARGS)
	
#line 52 "file_analysis.bif"
{
	if ( BiF_ARGS->length() != 3 )
		{
		reporter->Error("Files::__remove_analyzer() takes exactly 3 argument(s)");
		return 0;
		}
	StringVal* file_id = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());
	Val* tag = (Val*) ((*BiF_ARGS)[1]);
	Val* args = (Val*) ((*BiF_ARGS)[2]);

#line 52 "file_analysis.bif"

	using BifType::Record::Files::AnalyzerArgs;
	RecordVal* rv = args->AsRecordVal()->CoerceTo(AnalyzerArgs);
	bool result = file_mgr->RemoveAnalyzer(file_id->CheckString(),
	                                       file_mgr->GetComponentTag(tag) , rv);
	Unref(rv);
	return new Val(result, TYPE_BOOL);
	} // end of BifFunc::Files::bro___remove_analyzer

#line 59 "file_analysis.bif"

#line 62 "file_analysis.bif"
Val* BifFunc::Files::bro___stop(Frame* frame, val_list* BiF_ARGS)
	
#line 63 "file_analysis.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("Files::__stop() takes exactly 1 argument(s)");
		return 0;
		}
	StringVal* file_id = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());

#line 63 "file_analysis.bif"

	bool result = file_mgr->IgnoreFile(file_id->CheckString());
	return new Val(result, TYPE_BOOL);
	} // end of BifFunc::Files::bro___stop

#line 66 "file_analysis.bif"

#line 69 "file_analysis.bif"
Val* BifFunc::Files::bro___analyzer_name(Frame* frame, val_list* BiF_ARGS) 
	
#line 70 "file_analysis.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("Files::__analyzer_name() takes exactly 1 argument(s)");
		return 0;
		}
	Val* tag = (Val*) ((*BiF_ARGS)[0]);

#line 70 "file_analysis.bif"

	return new StringVal(file_mgr->GetComponentName(tag));
	} // end of BifFunc::Files::bro___analyzer_name

#line 72 "file_analysis.bif"

#line 75 "file_analysis.bif"
Val* BifFunc::Files::bro___file_exists(Frame* frame, val_list* BiF_ARGS)
	
#line 76 "file_analysis.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("Files::__file_exists() takes exactly 1 argument(s)");
		return 0;
		}
	StringVal* fuid = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());

#line 76 "file_analysis.bif"

	if ( file_mgr->LookupFile(fuid->CheckString()) != nullptr )
		return new Val(true, TYPE_BOOL);
	else
		return new Val(false, TYPE_BOOL);
	} // end of BifFunc::Files::bro___file_exists

#line 81 "file_analysis.bif"

#line 84 "file_analysis.bif"
Val* BifFunc::Files::bro___lookup_file(Frame* frame, val_list* BiF_ARGS)
	
#line 85 "file_analysis.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("Files::__lookup_file() takes exactly 1 argument(s)");
		return 0;
		}
	StringVal* fuid = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());

#line 85 "file_analysis.bif"

	auto f = file_mgr->LookupFile(fuid->CheckString());
	if ( f != nullptr )
		{
		return f->GetVal()->Ref();
		}
	
	reporter->Error("file ID %s not a known file", fuid->CheckString());
	return 0;
	} // end of BifFunc::Files::bro___lookup_file

#line 94 "file_analysis.bif"

#line 106 "file_analysis.bif"
Val* BifFunc::bro_set_file_handle(Frame* frame, val_list* BiF_ARGS)
	
#line 107 "file_analysis.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("set_file_handle() takes exactly 1 argument(s)");
		return 0;
		}
	StringVal* handle = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());

#line 107 "file_analysis.bif"

	file_mgr->SetHandle(handle->CheckString());
	return 0;
	} // end of BifFunc::bro_set_file_handle

#line 110 "file_analysis.bif"
namespace BifConst { namespace Files {  StringVal* salt;  }  }
