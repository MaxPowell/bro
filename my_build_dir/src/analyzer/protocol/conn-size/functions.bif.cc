// This file was automatically generated by bifcl from /home/ubuntu/bro/src/analyzer/protocol/conn-size/functions.bif (plugin mode).


#include "functions.bif.h"


#line 1 "functions.bif"

#include "analyzer/protocol/conn-size/ConnSize.h"

static analyzer::Analyzer* GetConnsizeAnalyzer(Val* cid)
	{
	Connection* c = sessions->FindConnection(cid);
	if ( ! c )
		return 0;

	analyzer::Analyzer* a = c->FindAnalyzer("CONNSIZE");
	if ( ! a )
		reporter->Error("connection does not have ConnSize analyzer");

	return a;
	}


#line 31 "functions.bif"
Val* BifFunc::bro_set_current_conn_bytes_threshold(Frame* frame, val_list* BiF_ARGS)
	
#line 32 "functions.bif"
{
	if ( BiF_ARGS->length() != 3 )
		{
		reporter->Error("set_current_conn_bytes_threshold() takes exactly 3 argument(s)");
		return 0;
		}
	Val* cid = (Val*) ((*BiF_ARGS)[0]);
	bro_uint_t threshold = (bro_uint_t) ((*BiF_ARGS)[1]->AsCount());
	int is_orig = (int) ((*BiF_ARGS)[2]->AsBool());

#line 32 "functions.bif"

	analyzer::Analyzer* a = GetConnsizeAnalyzer(cid);
	if ( ! a )
		return new Val(0, TYPE_BOOL);

	static_cast<analyzer::conn_size::ConnSize_Analyzer*>(a)->SetThreshold(threshold, 1, is_orig);

	return new Val(1, TYPE_BOOL);
	} // end of BifFunc::bro_set_current_conn_bytes_threshold

#line 40 "functions.bif"

#line 54 "functions.bif"
Val* BifFunc::bro_set_current_conn_packets_threshold(Frame* frame, val_list* BiF_ARGS)
	
#line 55 "functions.bif"
{
	if ( BiF_ARGS->length() != 3 )
		{
		reporter->Error("set_current_conn_packets_threshold() takes exactly 3 argument(s)");
		return 0;
		}
	Val* cid = (Val*) ((*BiF_ARGS)[0]);
	bro_uint_t threshold = (bro_uint_t) ((*BiF_ARGS)[1]->AsCount());
	int is_orig = (int) ((*BiF_ARGS)[2]->AsBool());

#line 55 "functions.bif"

	analyzer::Analyzer* a = GetConnsizeAnalyzer(cid);
	if ( ! a )
		return new Val(0, TYPE_BOOL);

	static_cast<analyzer::conn_size::ConnSize_Analyzer*>(a)->SetThreshold(threshold, 0, is_orig);

	return new Val(1, TYPE_BOOL);
	} // end of BifFunc::bro_set_current_conn_packets_threshold

#line 63 "functions.bif"

#line 75 "functions.bif"
Val* BifFunc::bro_get_current_conn_bytes_threshold(Frame* frame, val_list* BiF_ARGS)
	
#line 76 "functions.bif"
{
	if ( BiF_ARGS->length() != 2 )
		{
		reporter->Error("get_current_conn_bytes_threshold() takes exactly 2 argument(s)");
		return 0;
		}
	Val* cid = (Val*) ((*BiF_ARGS)[0]);
	int is_orig = (int) ((*BiF_ARGS)[1]->AsBool());

#line 76 "functions.bif"

	analyzer::Analyzer* a = GetConnsizeAnalyzer(cid);
	if ( ! a )
		return new Val(0, TYPE_COUNT);

	return new Val(
		static_cast<analyzer::conn_size::ConnSize_Analyzer*>(a)->GetThreshold(1, is_orig),
		TYPE_COUNT);
	} // end of BifFunc::bro_get_current_conn_bytes_threshold

#line 84 "functions.bif"

#line 96 "functions.bif"
Val* BifFunc::bro_get_current_conn_packets_threshold(Frame* frame, val_list* BiF_ARGS)
	
#line 97 "functions.bif"
{
	if ( BiF_ARGS->length() != 2 )
		{
		reporter->Error("get_current_conn_packets_threshold() takes exactly 2 argument(s)");
		return 0;
		}
	Val* cid = (Val*) ((*BiF_ARGS)[0]);
	int is_orig = (int) ((*BiF_ARGS)[1]->AsBool());

#line 97 "functions.bif"

	analyzer::Analyzer* a = GetConnsizeAnalyzer(cid);
	if ( ! a )
		return new Val(0, TYPE_COUNT);

	return new Val(
		static_cast<analyzer::conn_size::ConnSize_Analyzer*>(a)->GetThreshold(0, is_orig),
		TYPE_COUNT);
	} // end of BifFunc::bro_get_current_conn_packets_threshold

#line 105 "functions.bif"
