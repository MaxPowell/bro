// This file was automatically generated by bifcl from /home/ubuntu/bro/src/analyzer/protocol/ssl/functions.bif (plugin mode).


#include "functions.bif.h"


#line 2 "functions.bif"

#include "analyzer/protocol/ssl/SSL.h"
#include <openssl/x509.h>

#line 11 "functions.bif"
Val* BifFunc::bro_set_ssl_established(Frame* frame, val_list* BiF_ARGS)
	
#line 12 "functions.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("set_ssl_established() takes exactly 1 argument(s)");
		return 0;
		}
	Connection* c = (Connection*) ((*BiF_ARGS)[0]->AsRecordVal()->GetOrigin());

#line 12 "functions.bif"

	analyzer::Analyzer* sa = c->FindAnalyzer("SSL");
	if ( sa )
		static_cast<analyzer::ssl::SSL_Analyzer*>(sa)->StartEncryption();
	return 0;
	} // end of BifFunc::bro_set_ssl_established

#line 17 "functions.bif"
